function addToSVG(e,a,t){el=$(document.createElementNS("http://www.w3.org/2000/svg",e)),el.attr(a).appendTo(t)}function addTextToSVG(e,a,t,r){el=$(document.createElementNS("http://www.w3.org/2000/svg",e)),el.text(r),el.attr(a).appendTo(t)}function resolveCoOrdinates(e){"use strict";var a=e-1,t=10-Math.floor(a/10),r=a%10+1;t%2!==0&&(r=11-r);var l=20*r-10,i=20*t-10;return{X:l,Y:i}}function createLadder(){const e=81;for(var a=0;-1!==$.inArray(a,blockedPlaces);)a=Math.floor(Math.random()*e);for(var t=0;-1!==$.inArray(t,blockedPlaces);){var r=Math.floor((a-1)/10),l=r+1,i=10*l+1;t=i+Math.floor(Math.random()*(100-i))}return blockedPlaces.push(a),blockedPlaces.push(t),{S:a,F:t}}function createSnake(){const e=11;for(var a=0;-1!==$.inArray(a,blockedPlaces);)a=e+Math.floor(89*Math.random());for(var t=0,r=0;-1!==$.inArray(r,blockedPlaces);){if(t>200){console.log("Max collision reached: finish value set - ",r);break}t++;var l=Math.floor((a-1)/10),i=l,o=10*i;r=Math.floor(Math.random()*o)}return blockedPlaces.push(a),blockedPlaces.push(r),{S:a,F:r}}function newBoardLayout(){"use strict";ladders=[],snakes=[],blockedPlaces=[0,1,100];var e=8,a=8;$("#id-snl-ladders-svg").empty(),$("#id-snl-snakes-svg").empty();for(var t=0;e>t;++t){var r=createLadder();ladders.push({start:r.S,finish:r.F})}for(t=0;a>t;++t){var l=createSnake();snakes.push({start:l.S,finish:l.F})}console.log(snakes,ladders)}function drawLadders(){"use strict";var e="#id-snl-ladders-svg";for(var a in ladders){var t=resolveCoOrdinates(ladders[a].start),r=resolveCoOrdinates(ladders[a].finish);t.X===r.X&&(r.X=r.X-2,t.X=t.X+2);var l=Math.atan((t.Y-r.Y)/(t.X-r.X));const i=4;var o=(t.X+i*Math.sin(l)).toFixed(1),n=(t.Y-i*Math.cos(l)).toFixed(1),s=(t.X-i*Math.sin(l)).toFixed(1),d=(t.Y+i*Math.cos(l)).toFixed(1),c=(r.X+i*Math.sin(l)).toFixed(1),u=(r.Y-i*Math.cos(l)).toFixed(1),f=(r.X-i*Math.sin(l)).toFixed(1),y=(r.Y+i*Math.cos(l)).toFixed(1);addToSVG("line",{x1:r.X,y1:r.Y,x2:t.X,y2:t.Y,stroke:"white","stroke-width":8,"stroke-opacity":1,"stroke-dasharray":"0.25, 3.75"},e),addToSVG("line",{x1:o,y1:n,x2:c,y2:u,stroke:"#dddddd","stroke-width":.5,"stroke-opacity":1},e),addToSVG("line",{x1:s,y1:d,x2:f,y2:y,stroke:"#dddddd","stroke-width":.5,"stroke-opacity":1},e);var P=0>l?-1:1,h=0>l?l*(180/Math.PI)+90:l*(180/Math.PI)-90,p=(t.X+2*P*Math.cos(l)).toFixed(1),m=(t.Y+2*P*Math.sin(l)).toFixed(1);addToSVG("circle",{cx:p,cy:m,r:2,fill:"white"},e),addTextToSVG("text",{x:p,y:m,fill:"green","font-family":"Helvetica Neue, sans-serif","font-size":2,"text-anchor":"middle","alignment-baseline":"middle",transform:"rotate("+h+" "+p+","+m+")"},e,ladders[a].finish)}}function drawSnakes(){"use strict";var e="#id-snl-snakes-svg";for(var a in snakes){var t=resolveCoOrdinates(snakes[a].start),r=resolveCoOrdinates(snakes[a].finish);t.X===r.X&&(r.X=r.X-2);var l=Math.atan((t.Y-r.Y)/(t.X-r.X));const i=6;var o=(t.X+i*Math.sin(l)).toFixed(1),n=(t.Y-i*Math.cos(l)).toFixed(1),s=(t.X-i*Math.sin(l)).toFixed(1),d=(t.Y+i*Math.cos(l)).toFixed(1),c="M"+r.X+","+r.Y+" L"+o+","+n+" "+s+","+d+" Z L"+t.X+","+t.Y;addToSVG("path",{d:c,fill:"transparent",stroke:"gold","stroke-width":.25},e);var u=0>l?1:0;c="M"+o+","+n+" A"+i+","+i+" 0 0,"+u+" "+s+","+d+" Z",addToSVG("path",{d:c,fill:"#e74c3c",stroke:"gold","stroke-width":.25},e);var f=0>l?1:-1,y=0>l?l*(180/Math.PI)+90:l*(180/Math.PI)-90,P=(t.X+2*f*Math.cos(l)).toFixed(1),h=(t.Y+2*f*Math.sin(l)).toFixed(1);addToSVG("circle",{cx:P,cy:h,r:2,fill:"white"},e),addTextToSVG("text",{x:P,y:h,fill:"#e74c3c","font-family":"Helvetica Neue, sans-serif","font-size":2,"text-anchor":"middle","alignment-baseline":"middle",transform:"rotate("+y+" "+P+","+h+")"},e,snakes[a].finish),addToSVG("circle",{cx:r.X,cy:r.Y,r:1.5,stroke:"gold","stroke-width":.25,fill:"#e74c3c"},e)}}function playSound(e){if(!soundMute){var a=document.createElement("audio");a.setAttribute("src","./static/sound/"+e),a.setAttribute("autoplay","autoplay"),a.addEventListener("load",function(){a.play()},!0)}}function highlightNextCell(){for(var e=1;100>=e;++e)$("#id-snl-cell-"+e).css("background-image","none");setTimeout(function(){$("#id-snl-cell-"+PlayerPosition[currentPlayer]).css("background","url(static/img/assets/activecell.svg) no-repeat center center"),$("#id-snl-cell-"+PlayerPosition[currentPlayer]).css("background-size","100%")},2e3)}function animateMove(e){var a="id-snl-cell-"+e,t="id-snl-cell-"+PlayerPosition[currentPlayer];0===e?$("#"+t+"> .player"+currentPlayer).delay(1500).fadeIn("slow"):($("#"+a+"> .player"+currentPlayer).delay(500).fadeOut("slow"),$("#"+t+"> .player"+currentPlayer).delay(1500).fadeIn("slow")),$("#"+t+"> .player"+currentPlayer).attr("data-original-title",Player[currentPlayer]+": "+PlayerPosition[currentPlayer]),$("#"+t+"> .player"+currentPlayer+" + .tooltip > .tooltip-inner").css("color",PlayerCol[currentPlayer]),console.log("%cGG "+a+" "+t,"background: #222; color: #bada55; padding: 2px 8px; border-radius: 4px;");var r="%c"+Player[currentPlayer]+" moves from "+e+" to "+PlayerPosition[currentPlayer];console.log(r,"background: #222; color: #bada55; padding: 2px 8px; border-radius: 4px;")}function makeMoves(){for(var e in diceRollQueue){var a=PlayerPosition[currentPlayer];PlayerPosition[currentPlayer]=PlayerPosition[currentPlayer]+diceRollQueue[e],PlayerPosition[currentPlayer]>100?PlayerPosition[currentPlayer]=200-PlayerPosition[currentPlayer]:100===PlayerPosition[currentPlayer]&&(gameEnded=!0,extraLadderRoll=0,console.log(Player[currentPlayer],"wins!")),animateMove(a);for(var t in ladders)if(ladders[t].start===PlayerPosition[currentPlayer]){PlayerPosition[currentPlayer]=ladders[t].finish,setTimeout(playSound("ladder.mp3"),1500),console.log("Ladder"),animateMove(ladders[t].start),++extraLadderRoll;break}for(var r in snakes)if(snakes[r].start===PlayerPosition[currentPlayer]){PlayerPosition[currentPlayer]=snakes[r].finish,setTimeout(playSound("snake.mp3"),1500),console.log("Snake"),animateMove(snakes[r].start);break}if($("#id-snl-player-"+currentPlayer+" a span i").text(" "+PlayerPosition[currentPlayer]),gameEnded)break}}function postDiceRoll(){if(diceRollQueue.push(currentDiceValue),6===currentDiceValue){ongoingMove=!0;var e=diceRollQueue.length;if(e>=3){var a=diceRollQueue[e-1]+diceRollQueue[e-2]+diceRollQueue[e-3];18===a&&(diceRollQueue=[])}}else console.log(Player[currentPlayer],"at",PlayerPosition[currentPlayer],"rolled",diceRollQueue),makeMoves(),diceRollQueue=[],ongoingMove=!1,0>=extraLadderRoll&&!gameEnded?currentPlayer=currentPlayer%totalPlayers+1:--extraLadderRoll}function resetGameplay(e){gameEnded=!1,currentPlayer=1,currentDiceValue=0,ongoingMove=!1,diceRollQueue=[],extraLadderRoll=0,setTimeout(function(){for(var a in PlayerPosition){var t="id-snl-cell-"+PlayerPosition[a];console.log(a,$("#"+t+"> .player"+a)),$("#"+t+"> .player"+a).delay(500*e).fadeOut("slow"),$("#"+t).css("background-image","none"),PlayerPosition[a]=0}for(var r=1;totalPlayers>=r;++r)$("#id-snl-player-"+r).removeClass("active"),$("#id-snl-player-"+r+" a span i").text("");$("#id-snl-player-1").addClass("active")},2500*e)}function showWinModal(){playSound("win.mp3"),$("#id-snl-win-modalLabel > i").text(" Winner: "+Player[currentPlayer]);for(var e=1;totalPlayers>=e;++e)$("#id-snl-result-p"+e+" i").text(" "+Player[e]+": "+PlayerPosition[e]);$("#id-snl-win-modal").modal("show",{keyboard:!1})}const debug=!0;var Player={1:"Player 1",2:"Player 2",3:"Player 3",4:"Player 4"},PlayerCol={1:"#e74c3c",2:"#3498db",3:"#2ecc71",4:"f1c40f"},PlayerPosition={1:0,2:0,3:0,4:0},ladders=[{start:5,finish:14},{start:9,finish:31},{start:20,finish:38},{start:28,finish:84},{start:40,finish:59},{start:51,finish:67},{start:63,finish:81},{start:71,finish:91}],snakes=[{start:99,finish:78},{start:95,finish:75},{start:93,finish:73},{start:87,finish:24},{start:64,finish:60},{start:62,finish:19},{start:54,finish:34},{start:17,finish:7}],noOfSnakes=8,noOfLadders=8,blockedPlaces=[0,1,100],totalPlayers=4,currentPlayer=1,currentDiceValue=0,ongoingMove=!1,diceRollQueue=[],extraLadderRoll=0,gameEnded=!1,soundMute=!0;if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";var e=$.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1===e[0]&&9===e[1]&&e[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function($){$("#id-snl-mute i").css("color","red"),$("#id-snl-mute").click(function(){soundMute=!soundMute,soundMute?($("#id-snl-mute i").removeClass("fa-bell"),$("#id-snl-mute i").addClass("fa-bell-slash"),$("#id-snl-mute i").css("color","red")):($("#id-snl-mute i").removeClass("fa-bell-slash"),$("#id-snl-mute i").addClass("fa-bell"),$("#id-snl-mute i").css("color","green"))})}(jQuery),+function($){"use strict";for(var e=$("#id-snl-board"),a=99;a>=0;--a){var t=a+1;Math.floor(a/10)%2===0&&(t=10*(Math.floor(a/10)+1)-a%10);var r="id-snl-cell-"+t,l='<p class="snl-cell-player player1" data-placement="left" data-toggle="tooltip" data-original-title="Player 1"><i class="fa fa-lg fa-circle"> </i></p>';l+='<p class="snl-cell-player player2" data-placement="left" data-toggle="tooltip" data-original-title="Player 2"><i class="fa fa-lg fa-circle"> </i></p>',l+='<p class="snl-cell-player player3" data-placement="left" data-toggle="tooltip" data-original-title="Player 3"><i class="fa fa-lg fa-circle"> </i></p>',l+='<p class="snl-cell-player player4" data-placement="left" data-toggle="tooltip" data-original-title="Player 4"><i class="fa fa-lg fa-circle"> </i></p>';var i="<div id='"+r+"' class='snl-cell left' title='' data-placement='left' data-toggle='tooltip' data-original-title='"+t+"'>"+l+"</div>";e.append(i)}for(var o=0;10>=o;o+=2)$("#id-snl-cell-"+10*o).attr("data-placement","right"),$("#id-snl-cell-"+(10*o+1)).attr("data-placement","right");$(".snl-cell-player").tooltip()}(jQuery),+function($){"use strict";newBoardLayout()}(jQuery),+function($){"use strict";for(var e="#id-snl-checkers-svg",a=99;a>=0;--a){var t=a+1;Math.floor(a/10)%2===0&&(t=10*(Math.floor(a/10)+1)-a%10);var r=resolveCoOrdinates(t),l=["green","white"];addToSVG("rect",{x:r.X-10,y:r.Y-10,rx:0,ry:0,width:20,height:20,fill:"green",stroke:"#ffffff","stroke-width":.25,"stroke-opacity":.5},e),addToSVG("circle",{cx:r.X-5,cy:r.Y+5,r:4,fill:"white",stroke:"white",opacity:.1},e),addTextToSVG("text",{x:r.X-5,y:r.Y+5,fill:"white","font-family":"Helvetica Neue, sans-serif","font-size":4,"text-anchor":"middle","alignment-baseline":"middle"},e,t)}addTextToSVG("text",{x:10,y:188,fill:"white","font-family":"Helvetica Neue, sans-serif","font-size":4,"text-anchor":"middle","alignment-baseline":"middle"},e,"Start"),addTextToSVG("text",{x:10,y:8,fill:"white","font-family":"Helvetica Neue, sans-serif","font-size":4,"text-anchor":"middle","alignment-baseline":"middle"},e,"Finish")}(jQuery),+function($){"use strict";drawLadders(),drawSnakes()}(jQuery),+function($){"use strict";$("#id-snl-dice-big").delay(1e3).fadeOut(),$("#id-snl-dice").bind("click",function(){if(!gameEnded){currentDiceValue=Math.floor(6*Math.random())+1,playSound(6===currentDiceValue?"dicerollsix.mp3":"diceroll.mp3");var e="./static/img/assets/diceface-"+currentDiceValue+".svg";$("#id-snl-dice-big").attr("src",e),$("#id-snl-dice-big").fadeIn("slow"),$("#id-snl-dice-big").delay(500).fadeOut("slow"),$("#id-snl-diceface > img").fadeOut("fast",function(){$("#id-snl-diceface > img").attr("src",e)}),$("#id-snl-diceface > img").delay(500).fadeIn("fast"),0||(currentDiceValue=50)}})}(jQuery),+function($){$(document).on("click","#id-snl-modal-btn-game",function(e){resetGameplay(0)})}(jQuery),+function($){$(document).on("click","#id-snl-modal-btn-board",function(e){resetGameplay(0),newBoardLayout(),drawLadders(),drawSnakes()})}(jQuery),+function($){$(document).on("click","#id-snl-modal-btn-report",function(e){e.preventDefault(),$.post("/report",{email:$("#id-snl-report-email").val(),title:$("#id-snl-report-title").val(),details:$("#id-snl-report-details").val()},function(e){console.log(e.result)})})}(jQuery),+function($){$("#id-snl-new-game").bind("click",function(){resetGameplay(0)}),$("#id-snl-new-board").bind("click",function(){newBoardLayout(),drawLadders(),drawSnakes()}),$("#id-snl-current-score").bind("click",function(){$("#id-snl-win-modalLabel > i").text(" Currect Score");for(var e=1;totalPlayers>=e;++e)$("#id-snl-result-p"+e+" i").text(" "+Player[e]+": "+PlayerPosition[e])})}(jQuery),+function($){"use strict";$("#id-snl-dice").bind("click",function(){if(console.clear(),console.log("R:",PlayerPosition[1],"B:",PlayerPosition[2],"G:",PlayerPosition[3],"Y:",PlayerPosition[4]),!gameEnded&&(postDiceRoll(),!ongoingMove)){for(var e=1;totalPlayers>=e;++e)$("#id-snl-player-"+e).removeClass("active");setTimeout(function(){$("#id-snl-player-"+currentPlayer).addClass("active")},1500),highlightNextCell()}gameEnded&&setTimeout(function(){showWinModal()},1e3),console.log("R:",PlayerPosition[1],"B:",PlayerPosition[2],"G:",PlayerPosition[3],"Y:",PlayerPosition[4])})}(jQuery);